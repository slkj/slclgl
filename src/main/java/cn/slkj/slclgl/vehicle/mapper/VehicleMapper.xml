<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.slkj.slclgl.vehicle.mapper.VehicleMapper">

	<sql id="sql_temp">
		id,companyId,(select compName from  tb_company where id = companyId) as companyName,carOwner,
		carOwnersType,carOwnersCard,contacts,contactsTel,carNumber,carNumberG,plateColor,classify
		,carType,carBrand,carModel,carColor,carVin,carProType,carOutLength,carOutWidth,carOutHeight,
		carTotalmass,carEngNum,carEngModel,carFuelType,carDisplacement,carPower,carManuName,carModality,
		carTreadBe,carTreadAfter,carTireNum,carTireSpe,carNumOfSpring,carAxleDist,carAxleNum,carContLength,
		carContWidth,carContHeight,carApproved,carApprGuest,carTrac,carCabGuest,carUseNatu,carUseNatuName,
		carObtWay,carFacDate,installers,attendants,installtime,installAddress,fees,feeseEnd,isNotice,
		simPayer,payerTime,CTradingLine,CCatchMenbers,carImg,entryTime,entryId,entryName,depId,
		simNumber,equitment,networkNo,remark
	</sql>
	
	<sql id="sql_car">
		TBV.ID,COMPANYID, TBC.COMPNAME AS COMPANYNAME,CAROWNER,
		CAROWNERSTYPE,CAROWNERSCARD,CONTACTS,CONTACTSTEL,CARNUMBER,CARNUMBERG,PLATECOLOR,CLASSIFY
		,CARTYPE,CARBRAND,CARMODEL,CARCOLOR,CARVIN,CARPROTYPE,CAROUTLENGTH,CAROUTWIDTH,CAROUTHEIGHT,
		CARTOTALMASS,CARENGNUM,CARENGMODEL,CARFUELTYPE,CARDISPLACEMENT,CARPOWER,CARMANUNAME,CARMODALITY,
		CARTREADBE,CARTREADAFTER,CARTIRENUM,CARTIRESPE,CARNUMOFSPRING,CARAXLEDIST,CARAXLENUM,CARCONTLENGTH,
		CARCONTWIDTH,CARCONTHEIGHT,CARAPPROVED,CARAPPRGUEST,CARTRAC,CARCABGUEST,CARUSENATU,CARUSENATUNAME,
		CAROBTWAY,CARFACDATE,INSTALLERS,ATTENDANTS,INSTALLTIME,INSTALLADDRESS,FEES,FEESEEND,ISNOTICE,
		SIMPAYER,PAYERTIME,CTRADINGLINE,CCATCHMENBERS,CARIMG,ENTRYTIME,ENTRYID,ENTRYNAME,DEPID,
		SIMNUMBER,EQUITMENT,NETWORKNO,REMARK
	</sql>
	<select id="queryList" resultType="Vehicle" parameterType="hashmap">
			SELECT <include refid="sql_car"/>  FROM TB_VEHICLE TBV
			LEFT JOIN TB_COMPANY TBC ON TBV.COMPANYID = TBC.ID
			<where>
				<if test="listnum != null and listnum != ''">
					AND TBV.LISTNUM  LIKE  CONCAT('%',#{listnum},'%')   
				</if>
				<if test="phone != null and phone != ''">
					AND TBV.SIMNUMBER  LIKE   CONCAT('%',#{phone},'%')   
				</if>
				<if test="companyName != null and companyName != ''">
					AND TBC.COMPNAME  LIKE   CONCAT('%',#{companyName},'%')   
				</if>
				<if test="carNumber != null and carNumber != ''">
					AND TBV.CARNUMBER  LIKE   CONCAT('%',#{carNumber},'%')   
				</if>
			</where>
			<if test="sort != null and sort != ''">
				ORDER BY  ${sort}       ${order}
			</if>
			LIMIT #{startPage},#{endPage}
	</select>

	<select id="queryListCount" resultType="int" parameterType="hashmap">
		SELECT COUNT(tbv.id)   FROM TB_VEHICLE TBV
			LEFT JOIN TB_COMPANY TBC ON TBV.COMPANYID = TBC.ID
			<where>
				<if test="listnum != null and listnum != ''">
					AND TBV.LISTNUM  LIKE  CONCAT('%',#{listnum},'%')   
				</if>
				<if test="phone != null and phone != ''">
					AND TBV.SIMNUMBER  LIKE   CONCAT('%',#{phone},'%')   
				</if>
				<if test="companyName != null and companyName != ''">
					AND TBC.COMPNAME  LIKE   CONCAT('%',#{companyName},'%')   
				</if>
				<if test="carNumber != null and carNumber != ''">
					AND TBV.CARNUMBER  LIKE   CONCAT('%',#{carNumber},'%')   
				</if>
			</where>
	</select>
	<select id="queryOne" parameterType="hashmap" resultType="vehicle">
		SELECT <include refid="sql_temp"></include> FROM TB_VEHICLE
			<where>
				<if test="id != null and id != ''">
					AND ID  = #{id}
				</if>
				<if test="carNumber != null and carNumber != ''">
					AND CARNUMBER  LIKE  '%' + #{carNumber}  + '%'
				</if>
			</where>
	</select>

	<insert id="save" parameterType="Vehicle">
		INSERT INTO TB_VEHICLE(
			carOwner,carOwnersType,carOwnersCard,contacts,contactsTel,carNumber,carNumberG,plateColor,classify
			,carType,carBrand,carModel,carColor,carVin,carProType,carOutLength,carOutWidth,carOutHeight,
			carTotalmass,carEngNum,carEngModel,carFuelType,carDisplacement,carPower,carManuName,carModality,
			carTreadBe,carTreadAfter,carTireNum,carTireSpe,carNumOfSpring,carAxleDist,carAxleNum,carContLength,
			carContWidth,carContHeight,carApproved,carApprGuest,carTrac,carCabGuest,carUseNatu,carUseNatuName,
			carObtWay,carFacDate,installers,attendants,installtime,installAddress,fees,feeseEnd,isNotice,
			simPayer,payerTime,CTradingLine,CCatchMenbers,carImg,entryTime,entryId,entryName,depId,simNumber,equitment,networkNo,remark,companyId
		)
		VALUES(
			#{carOwner},#{carOwnersType},#{carOwnersCard},#{contacts},#{contactsTel},#{carNumber},#{carNumberG},#{plateColor},#{classify},
			#{carType},#{carBrand},#{carModel},#{carColor},#{carVin},#{carProType},#{carOutLength},#{carOutWidth},#{carOutHeight},
			#{carTotalmass},#{carEngNum},#{carEngModel},#{carFuelType},#{carDisplacement},#{carPower},#{carManuName},#{carModality},
			#{carTreadBe},#{carTreadAfter},#{carTireNum},#{carTireSpe},#{carNumOfSpring},#{carAxleDist},#{carAxleNum},#{carContLength},
			#{carContWidth},#{carContHeight},#{carApproved},#{carApprGuest},#{carTrac},#{carCabGuest},#{carUseNatu},#{carUseNatuName}
			,#{carObtWay},#{carFacDate},#{installers},#{attendants},#{installtime},#{installAddress},#{fees},#{feeseEnd},#{isNotice},
			#{simPayer},#{payerTime},#{CTradingLine},#{CCatchMenbers},#{carImg},#{entryTime},#{entryId},#{entryName},#{depId},
			#{simNumber},#{equitment},#{networkNo},#{remark},#{companyId}
		)
	</insert>

	<update id="edit" parameterType="Vehicle">
		UPDATE TB_VEHICLE SET  
		carOwner=#{carOwner},carOwnersType=#{carOwnersType},carOwnersCard=#{carOwnersCard},contacts=#{contacts},
		contactsTel=#{contactsTel},carNumber=#{carNumber},carNumberG=#{carNumberG},plateColor=#{plateColor},classify=#{classify},
		carType=#{carType},carBrand=#{carBrand},carModel=#{carModel},carColor=#{carColor},carVin=#{carVin},carProType=#{carProType},
		carOutLength=#{carOutLength},carOutWidth=#{carOutWidth},carOutHeight=#{carOutHeight},carTotalmass=#{carTotalmass},
		carEngNum=#{carEngNum},carEngModel=#{carEngModel},carFuelType=#{carFuelType},carDisplacement=#{carDisplacement},carPower=#{carPower},
		carManuName=#{carManuName},carModality=#{carModality},carTreadBe=#{carTreadBe},carTreadAfter=#{carTreadAfter},carTireNum=#{carTireNum},
		carTireSpe=#{carTireSpe},carNumOfSpring=#{carNumOfSpring},carAxleDist=#{carAxleDist},carAxleNum=#{carAxleNum},carContLength=#{carContLength},
		carContWidth=#{carContWidth},carContHeight=#{carContHeight},carApproved=#{carApproved},carApprGuest=#{carApprGuest},carTrac=#{carTrac},
		carCabGuest=#{carCabGuest},carUseNatu=#{carUseNatu},carUseNatuName=#{carUseNatuName},carObtWay=#{carObtWay},carFacDate=#{carFacDate},
		installers=#{installers},attendants=#{attendants},installtime=#{installtime},installAddress=#{installAddress},fees=#{fees},
		feeseEnd=#{feeseEnd},isNotice=#{isNotice},simPayer=#{simPayer},payerTime=#{payerTime},CTradingLine=#{CTradingLine},
		CCatchMenbers=#{CCatchMenbers},carImg=#{carImg},entryTime=#{entryTime},entryId=#{entryId},entryName=#{entryName},depId=#{depId},simNumber=#{simNumber},
		equitment=#{equitment},networkNo=#{networkNo},remark=#{remark},companyId=#{companyId}
		WHERE ID = #{id}
	</update>
	<update id="activated" parameterType="Vehicle">
		UPDATE TB_VEHICLE SET
			simNumber=#{simNumber},equitment=#{equitment},networkNo=#{networkNo},
			installers=#{installers},installtime=#{installtime},installAddress=#{installAddress},fees=#{fees},feeseEnd=#{feeseEnd},
			simPayer=#{simPayer},payerTime=#{payerTime},CTradingLine=#{CTradingLine},CCatchMenbers=#{CCatchMenbers},remark=#{remark} 
		WHERE ID = #{id}
	</update>
	<delete id="delete" parameterType="string">
		DELETE FROM TB_VEHICLE WHERE ID  = #{id}
	</delete>
</mapper>